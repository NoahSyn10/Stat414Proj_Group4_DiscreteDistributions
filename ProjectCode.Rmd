---
title: "STAT414"
author: "Aminah W, Noah S, Gabriella L, Nathanael N"
date: "2022-12-05"
output: pdf_document
---

# Binomial Distribution

The built-in function dbinom(x, size, probability) evaluates the probability density function (PDF) for a binomial distribution. For example, below the dbinom() is used to determine the probability of 3 successes in 5 trials (x = 3) given that the probability of a success is 0.2.

```{r eval==TRUE}
#binomial pdf
dbinom(3,5,0.2)
```

We can verify that dbinom() is accurate using the formula for the PDF of a binomial distribution:

```{r eval}
choose(5,3)*(0.2)^3*(0.8)^2
```

The built-in function pbinom(x, size, probability) evaluates the cumulative density function (CDF) for a binomial distribution. For example, below the pbinom() is used to determine the cumulative probability of 3 successes in 5 trials (x = 3) given that the probability of a success is 0.2.

```{r eval}
#binomial cdf
pbinom(3,5,0.2)
```

We can verify that pbinom() is accurate using the formula for the CDF of a binomial distribution:

```{r eval}
choose(5,0)*(0.2)^0*(0.8)^(5) + choose(5,1)*(0.2)^1*(0.8)^(4) + choose(5,2)*(0.2)^2*(0.8)^(3) + choose(5,3)*(0.2)^3*(0.8)^(2)
```

We can also plot the PDF and CDF.

```{r eval}
library(dplyr)
library(ggplot2)


x= 0:10
plot(pbinom(x,5,0.2), type = "s", main = "CDF Bin ~ (5, 0.2) for x = 0 to x = 10")



# expectation
x = c(0, 1, 2, 3)
prob = dbinom(x,5,0.2)*x
E = sum(prob)

# variance
prob2 =dbinom(x,5,0.2)*x^2
V = sum(prob2)-(sum(prob)^2)

x= 0:10
plot(dbinom(x,5,0.2), type = "h", main = "PDF Bin ~ (5, 0.2) for x = 0 to x = 10")
abline(v = E, col = "red")

text(2, 0.35, "Mean = 0.9728", col = "red")
text(2.2, 0.32, "Variance = 0.7433", col = "blue")


```

# Hypergeometric Distribution

The built-in function dhyper(x,m,n,k) evaluates the probability density function (PDF) for a hypergeometric distribution. For example, below the dhyper() is used to determine the probability ...(revise later)

```{r eval = TRUE}
# hypergeometric pdf
dhyper(2,4,6,5)
(choose(4,2)*choose(6,3))/choose(10,5)

# hypergeometric cdf
phyper(2,4,6,5) 
(choose(4,0)*choose(6,5))/choose(10,5) +(choose(4,1)*choose(6,4))/choose(10,5)+
(choose(4,2)*choose(6,3))/choose(10,5)

```

# Poisson Distribrution

```{r eval=TRUE}
#Poisson pdf
dpois(0,5/2)
(exp(-5/2)*(5/2)^0)/factorial(0)

#Poisson cdf
ppois(1,5/2)
(exp(-5/2)*(5/2)^0)/factorial(0) + (exp(-5/2)*(5/2)^1)/factorial(1)
```

# Sample Size

Sample size plays a big role in the shape of data.

```{r eval}

Samples = rbinom(100, 5, 0.2)
hist(Samples, breaks = 0:5.5, probability = TRUE, main = "Random Samples from Bin(5, 0.2) for x = 100")
lines(x, dbinom(x,5,0.2), col = "darkgreen", lwd = 2)
text(2.4, 0.3, "PMF for Bin(5,0.2)", col = "darkgreen")

```

# Relationship Between Distributions

While each Discrete Distribution has a unique meaning and application, they still have similar foundations, and thus hold observable relationships between each other. For example, we know that the Hypergeometric Distribution applies to a random variable X in a situation where there is a population size of N with m correct choices, and a sample size n chosen *without replacement*. Similarly, the Binomial Distribution applies to random variable X with a sample size of n and a *constant probability* p. Imagine that the Hypergeometric random variable's sample size was modified to be chosen *with replacement*. It is clear that the random variable would then have a Binomial Distribution with sample size n and constant probability p=m/N. Now imagine that the Hypergeometric random variable had a population size so large that taking a sample did not significantly change the ratio m/N. Then the PMF would be very similar to that of a Binomial Distribution with sample size n and probability m/N, as the probability would be *near constant*. In fact, as the population size of a Hypergeometric Distribution approaches infinity, its PMF approaches the PMF of a Binomial Distribution with p=m/N.

This can be illustrated by plotting the PMF of a Hypergeometric Distribution with a population size N and a sample size n much less than N, against the PMF of a Binomial distribution with sample size n and probability p=m/N, m being the number of correct choices in population N.

Lets consider a Hypergeometric Distribution with population N=1000, with m=100 correct choices and a sample size of n=50. We could approximate the PMF of that random variable with a Binomial Distribution with sample size n=50 and probability p=100/1000=0.1

```{r eval}

# Plot the PMFs for each distribution to illustrate their relations.

x <- 0:20

N=1000
m=100
n=50

# Probability of x successes in 50 trials with prob 0.1
binomPMF <- dbinom(x, n, m/N)

# Probability of x successes in 50 trials with 1000 choices, 100 of them correct.
hyperPMF <- dhyper(x, m, N-m, n)

# Probability of x occurances with an occurance rate of 10
poisPMF <- dpois(x, 5)


plot(hyperPMF, xlim = c(0, 20), ylim = c(0, 0.25), col='black', type='o')
points(binomPMF, xlim = c(0, 20), ylim = c(0, 0.25), col='red', type='b')
legend(15, 0.25, legend=c("Binomial", "Hyper Geometric"), 
       col=c("black", "red"), lty=1:2, cex=.75)

plot(binomPMF, xlim = c(0, 20), ylim = c(0, 0.25), col='black', type='o')
points(poisPMF, xlim = c(0, 20), ylim = c(0, 0.25), col='red', type='b')
legend(15, 0.25, legend=c("Poisson", "Binomial"), 
       col=c("black", "red"), lty=1:2, cex=.75)
```
